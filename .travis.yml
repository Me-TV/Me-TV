sudo: true
# dist: xenial

language: rust

before_install:
  - curl -L https://people.freedesktop.org/~slomo/gstreamer.tar.gz | tar xz
  - sed -i "s;prefix=/root/gstreamer;prefix=$PWD/gstreamer;g" $PWD/gstreamer/lib/x86_64-linux-gnu/pkgconfig/*.pc
  - export PKG_CONFIG_PATH=$PWD/gstreamer/lib/x86_64-linux-gnu/pkgconfig
  - export GST_PLUGIN_SYSTEM_PATH=$PWD/gstreamer/lib/x86_64-linux-gnu/gstreamer-1.0
  - export PATH=$PATH:$PWD/gstreamer/bin
  - export RUST_BACKTRACE=1

before_script:
  - sudo apt-get -qq update
  - sudo apt-get install -y libgtk-3-dev libatk1.0-dev libpango1.0-dev
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - sleep 3 # give xvfb some time to start
